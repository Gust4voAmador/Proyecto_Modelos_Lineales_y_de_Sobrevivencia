setwd("C:/Users/gusta/OneDrive - Universidad de Costa Rica/I-2025/Modelos lineales y de sobrevivencia/Proyecto Modelos")
library(readr)
library(dplyr)
library(ggplot2)
library(ggcorrplot)
data_raw <- read_csv("../data/Dengue diseases dataset.csv", show_col_types = FALSE)
#Creación de copia del df original (crudo)
data_clean <- data_raw
names(data_clean)[9] <- "Dengue Diagnosis"
#View(data_clean)
#Hacer varibla que determina el dengue booleana
#data_clean$`Dengue Diagnosis` <- as.logical(data_clean$`Dengue Diagnosis`)
# Filtrar solo las variables numéricas
datos_numericos <- data_clean %>%
select(where(is.numeric)) %>%
na.omit()  # eliminar NA para evitar errores en cor()
# Calcular matriz de correlación
cor_matrix <- cor(datos_numericos)
# Visualizar la matriz con ggcorrplot
plot_corr <- ggcorrplot(cor_matrix,
method = "square",
type = "lower",
lab = TRUE,
lab_size = 2.5,
colors = c("#6D9EC1", "white", "#E46726"),
#title = "Matriz de correlación entre variables",
ggtheme = ggplot2::theme_minimal())
print(plot_corr)
# Cambia esta ruta por la que desees usar
ruta_guardado <- "../img/matriz_correlacion.png"
ggsave(filename = ruta_guardado,
plot = plot_corr,
width = 8,
height = 6,
dpi = 300)
data_clean$`Dengue Diagnosis`
# Reemplazar NA por etiqueta explícita
data_plot <- data_clean %>%
mutate(`Dengue Diagnosis` = case_when(
is.na(`Dengue Diagnosis`) ~ "NA",
`Dengue Diagnosis` == 1 ~ "1",
`Dengue Diagnosis` == 0 ~ "0"
)) %>%
group_by(`Dengue Diagnosis`) %>%
summarise(Frecuencia = n()) %>%
mutate(Proporcion = Frecuencia / sum(Frecuencia))
# Gráfico
distri_dengue_diagnosis <- ggplot(data_plot, aes(x = `Dengue Diagnosis`, y = Proporcion, fill = `Dengue Diagnosis`)) +
geom_col() +
geom_text(aes(label = paste0(Frecuencia, " obs")), vjust = -0.5) +
scale_y_continuous(labels = scales::percent_format(), limits = c(0, 1.1)) +
labs(
x = "Valor de Dengue Diagnosis",
y = "Proporción del total",
#title = "Distribución de Dengue Diagnosis",
fill = "Valor"
) +
scale_fill_manual(values = c("0" = "gray70", "1" = "steelblue", "NA" = "darkred")) +
theme_minimal()
print(distri_dengue_diagnosis)
# Cambia esta ruta por la que desees usar
ruta_guardado <- "../img/Distribucion_Dengue_Diagnosis.png"
ggsave(filename = ruta_guardado,
plot = distri_dengue_diagnosis,
width = 8,
height = 6,
dpi = 300)
# Preparar los datos
data_plot <- data_clean %>%
filter(!is.na(`Dengue Diagnosis`)) %>%
mutate(
`Differential Count` = factor(`Differential Count`, levels = c(0, 1)),
`Dengue Diagnosis` = ifelse(`Dengue Diagnosis` == 1, "Positive", "Negative")
)
# Gráfico
dif_count <- ggplot(data_plot, aes(x = `Differential Count`, fill = `Differential Count`)) +
geom_bar() +
facet_wrap(~`Dengue Diagnosis`) +
labs(
title = "Distribución de Differential Count según diagnóstico de dengue",
x = "Differential Count",
y = "Frecuencia"
) +
scale_fill_manual(values = c("0" = "gray70", "1" = "steelblue")) +
theme_minimal()
print(dif_count)
# Cambia esta ruta por la que desees usar
ruta_guardado <- "../img/Distribucion_Differential_Count.png"
ggsave(filename = ruta_guardado,
plot = dif_count,
width = 8,
height = 6,
dpi = 300)
library(ggplot2)
library(dplyr)
# Preparar los datos
data_plot <- data_clean %>%
filter(!is.na(`RBC PANEL`)) %>%
mutate(
`RBC PANEL` = factor(`RBC PANEL`, levels = c(0, 1)),
`Dengue Diagnosis` = ifelse(`Dengue Diagnosis` == 1, "Positive", "Negative")
)
# Gráfico
rbc <- ggplot(data_plot, aes(x = `RBC PANEL`, fill = `RBC PANEL`)) +
geom_bar() +
facet_wrap(~`Dengue Diagnosis`) +
labs(
#title = "Distribución de RBC PANEL según diagnóstico de dengue",
x = "RBC PANEL",
y = "Frecuencia"
) +
scale_fill_manual(values = c("0" = "gray70", "1" = "steelblue")) +
theme_minimal()
print(rbc)
# Cambia esta ruta por la que desees usar
ruta_guardado <- "../img/Distribucion_RBC_PANEL.png"
ggsave(filename = ruta_guardado,
plot = rbc,
width = 8,
height = 6,
dpi = 300)
# Calcular resumen estadístico por grupo de diagnóstico
tabla_resumen <- data_clean %>%
group_by(`Dengue Diagnosis`) %>%
summarise(
Haemoglobin_mean = round(mean(Haemoglobin, na.rm = TRUE), 2),
Haemoglobin_sd = round(sd(Haemoglobin, na.rm = TRUE), 2),
Haemoglobin_median = round(median(Haemoglobin, na.rm = TRUE), 2)
)
# Mostrar tabla
print(tabla_resumen)
tabla_resumen <- data_clean %>%
group_by(`Dengue Diagnosis`) %>%
summarise(
WBC_Count_mean = round(mean(`WBC Count`, na.rm = TRUE), 2),
WBC_Count_sd = round(sd(`WBC Count`, na.rm = TRUE), 2),
WBC_Count_median = round(median(`WBC Count`, na.rm = TRUE), 2)
)
# Mostrar tabla
print(tabla_resumen)
tabla_resumen <- data_clean %>%
group_by(`Dengue Diagnosis`) %>%
summarise(
Platelet_Count_mean = round(mean(`Platelet Count`, na.rm = TRUE), 2),
Platelet_Count_sd = round(sd(`Platelet Count`, na.rm = TRUE), 2),
Platelet_Count_median = round(median(`Platelet Count`, na.rm = TRUE), 2)
)
# Mostrar tabla
print(tabla_resumen)
tabla_resumen <- data_clean %>%
group_by(`Dengue Diagnosis`) %>%
summarise(
PDW_mean = round(mean(PDW, na.rm = TRUE), 2),
PDW_sd = round(sd(PDW, na.rm = TRUE), 2),
PDW_median = round(median(PDW, na.rm = TRUE), 2)
)
# Mostrar tabla
print(tabla_resumen)
# Boxplot Haemoglobin
p1 <- ggplot(data_clean, aes(x = factor(`Dengue Diagnosis`), y = Haemoglobin)) +
geom_boxplot(fill = "#69b3a2") +
labs(title = "Haemoglobina por diagnóstico", x = "Diagnóstico de dengue", y = "g/dL") +
theme_minimal()
# Boxplot WBC Count
p2 <- ggplot(data_clean, aes(x = factor(`Dengue Diagnosis`), y = `WBC Count`)) +
geom_boxplot(fill = "#f9a825") +
labs(title = "Recuento de glóbulos blancos", x = "Diagnóstico de dengue", y = "células/µL") +
theme_minimal()
# Boxplot Platelet Count
p3 <- ggplot(data_clean, aes(x = factor(`Dengue Diagnosis`), y = `Platelet Count`)) +
geom_boxplot(fill = "#ef5350") +
labs(title = "Recuento de plaquetas", x = "Diagnóstico de dengue", y = "células/µL") +
theme_minimal()
# Boxplot PDW
p4 <- ggplot(data_clean, aes(x = factor(`Dengue Diagnosis`), y = PDW)) +
geom_boxplot(fill = "#B2FFFF") +
labs(title = "Amplitud de Distribución Plaquetaria", x = "Diagnóstico de dengue", y = "% de variabilidad en tamaño") +
theme_minimal()
# Mostrar juntos (si usás patchwork o gridExtra)
library(patchwork)
boxplot1 <- p1 + p2
boxplot1
boxplot2 <- p3 + p4
boxplot2
# Cambia esta ruta por la que desees usar
ruta_guardado1 <- "../img/Boxplot1.png"
ruta_guardado2 <- "../img/Boxplot2.png"
ggsave(filename = ruta_guardado1,
plot = boxplot1,
width = 8,
height = 6,
dpi = 300)
ggsave(filename = ruta_guardado2,
plot = boxplot2,
width = 8,
height = 6,
dpi = 300)
